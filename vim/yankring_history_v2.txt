,V
# if [[ "$OSTYPE" == "darwin"* ]]; then#   # if vim compiled with clientserver#   cs=`command vim --version | grep "clientserver"`#   if [ $cs ]#   then#     # Only use one instance of vim (call with "vims") to keep "vim" separate#     function vims()#     {#       if [ $@ ]#       then#         command vim --servername VIM --remote-silent $@#       else#         temp=`ps -e | grep -w "vim" | grep -v grep`#         if [ $temp  ]#         then#           echo "vim already open"#         else#           command vim --servername vim#         fi#       fi#     }#   else#     command vim $@#   fi# fi,V
x,v
,V
" Set "+ clipboard for all yank, delete, change and put that would normally go" to the unnamed register "*.,v
" Set "+ clipboard for all yank, delete, change and put that would normally go" to the unnamed register "*.,V
if [[ "$OSTYPE" == "darwin"* ]]; then,V
#-------------------------------------------------------#   UTILITIES#-------------------------------------------------------alias clc='clear'alias cp='cp -i'alias df='df -kTh'alias du='du -kh'alias egrep='egrep --color=auto'alias fgrep='fgrep --color=auto'alias gcc='gcc-4.9'alias grep='grep --color=auto'alias h='history'alias j='jobs -l'alias ldir="ls -l | grep '^d'"alias lf="ls -l | grep -v '^d'"alias lt='tree -C'alias mkdir='mkdir -p'alias mv='mv -i'alias mygcc='gcc -Wall -pedantic -std=c99'alias mygfortran='gfortran -Wall -pedantic -std=f95 -fbounds-check -ffree-line-length-0'alias r='rlogin'alias rm='rm -i'alias vi='vim'alias e='vim'alias which='type -all'alias zegrep='zegrep --color=auto'alias zfgrep='zfgrep --color=auto'alias zgrep='zgrep --color=auto'# alias myvalgrind='valgrind --leak-check=full --show-leak-kinds=all #                  '--track-origins=yes --dsymutil=yes --log-file=valout -v'# Color listif [[ "$OSTYPE" == "darwin"* ]]; then  # # alias lc='ls -hopG'               # Mac OS X alias    # If ~/.dircolors exists, set custom colors file  [ -e "$HOME/.dircolors" ] && DIR_COLORS="$HOME/.dircolors"  [ -e "$DIR_COLORS" ] || DIR_COLORS=""  eval "`gdircolors -b ~/.dircolors`"   # set custom colors file  alias lc='gls -Ghlp --color=auto'elif [[ "$OSTYPE" == "linux"* ]]; then  # If ~/.dircolors exists, set custom colors file  [ -e "$HOME/.dircolors" ] && DIR_COLORS="$HOME/.dircolors"  [ -e "$DIR_COLORS" ] || DIR_COLORS=""  eval "`dircolors -b ~/.dircolors`"    # set custom colors file  alias lc='ls -Ghlp --color=auto'      # Linux ls optionsfi# back up multiple directoriesalias ..='cd ..'alias .2='cd ../../'alias .3='cd ../../../'alias .4='cd ../../../../',V
f,v
\ \-pv,v
5 in,v
3.,v
 ,v
[Flow Curvature Effect],v
\subsection{Loads}Once \CR has converged to a mathematically-consistent set of \{$\vec{V_r}$, $\alfa_{kin}$, $C_L$, $\Gamma_b$, $\Gamma_w$, and $\vec{U}^*$\}, the loads are then calculated.  Again, if foil-foil and foil-wake interactions are ignored, then $\vec{U}^* = 0$, and \{$\vec{V_r}$, $\alfa_{kin}$, $C_L$, $\Gamma_b$\} are determined directly without iteration.Six forces and two moments (per unit length) are modeled in \CRV:\begin{equation}\vec{f}_{total\atop ~} = \vec{f}_{steady\atop lift} +\vec{f}_{steady\atop drag} +\vec{f}_{flow\atop curvature}  + \vec{f}_{unsteady\atop lift}+\vec{f}_{added\atop mass}  +\vec{f}_{acceleration\atop reaction}   \end{equation}\begin{equation}\vec{m}_{total\atop ~} = \vec{m}_{added\atop mass} +\vec{m}_{acceleration\atop reaction}    \end{equation}Since the foil is assumed to be symmetric, there is no moment about the center of pressure associated with the lift and drag forces.  %The first four forces (steady lift, steady drag, lift modification due to flow curvature, and unsteady lift) are all assumed to act at the aerodynamic center of pressure.  For a symmetric airfoil (assumed herein), this is the quarter chord point $\vec r_q$. The hydrodynamic added mass force is assumed to act at the midpoint of the foil $\vec r_m$.  The acceleration reaction force is assumed to act at the center of mass (centroid of area) $\vec r_a$.  The foil pitching point is located at $\vec r_p$.  These loads will produce moments about the rotor axis $\vec r = \vec R$ as follows:\begin{align}\vec m_0 = & \:(\vec r_q - \vec R) \times\left(\vec{f}_{steady\atop lift} +\vec{f}_{steady\atop drag} +\vec{f}_{flow\atop curvature}+\vec{f}_{unsteady\atop lift}\right) \nonumber \\ + & \,(\vec r_m - \vec R) \times  \vec{f}_{added\atop mass}  \nonumber \\ + & \,(\vec r_a - \vec R) \times  \vec{f}_{acceleration\atop reaction} \nonumber \\ &+ \vec{m}_{added\atop mass} + \vec{m}_{acceleration\atop reaction}  \end{align}Similarly, these loads will produce moments about the pitching point $\vec r_p$ as follows:\begin{align}\vec m_p = & \:(\vec r_q - \vec r_p) \times\left(\vec{f}_{steady\atop lift} +\vec{f}_{steady\atop drag} +\vec{f}_{flow\atop curvature}+\vec{f}_{unsteady\atop lift}\right) \nonumber \\ + & \,(\vec r_m - \vec r_p) \times  \vec{f}_{added\atop mass}  \nonumber \\ + & \,(\vec r_a - \vec r_p) \times  \vec{f}_{acceleration\atop reaction} \nonumber \\ &\:\:   \vec{m}_{added\atop mass} + \vec{m}_{acceleration\atop reaction}  \end{align}The circumferential average loads acting on both rotors over one revolution are \begin{align}\text{(thrust)} 		\quad 	T_{avg} 	&= \code{mean}\Big(\vec{f}_{total} \cdot (-\xhat)\Big) \, b \, (2\Z) \\\text{(side force)} 	\quad 	Y_{avg} 	&= \code{mean}\Big(\vec{f}_{total} \cdot \zhat\Big) \, b \, (2\Z) \\\text{(torque)} 		\quad 	Q_{avg} 	&= \code{mean}\Big(\quad \,          \vec m_0 \cdot \yhat\Big) \, b \, (2\Z) \\\text{(shaft power)} 	\quad 	P_{S_{avg}} &= \code{mean}\Big(  \dot\phi    \, (\vec m_0 \cdot \yhat) \Big) \, b \, (2\Z) = \dot\phi Q_{avg} \\\text{(pitching power)} \quad 	P_{P_{avg}} &= \code{mean}\Big(  \dot\beta   \, (\vec m_p \cdot \yhat) \Big) \, b \, (2\Z) \\\text{(total power)} 	\quad 	P_{avg} 	&= P_{S_{avg}} + P_{P_{avg}}\end{align}where $b$ is blade length, $\Z$ is the number of blades per rotor, and it is assumed that there are 2 rotors and thus $2\Z$ blades in total, as illustrated in Figure~\ref{fig_configurations}.  The sign convention for power is that these are the parasitic power loss; they are the power of the blade acting on the fluid  (i.e. the power put into the fluid that needs to come from the prime mover).  The efficiency of a cycloidal propeller is\begin{equation}\eta     = \frac{T_{avg} V_s}{P_{avg}}\end{equation}%%--------------------------------------------------------------------------%% Circumferential average loads on both rotors (b = blade length, 2*Z = total number of blades on 2 rotors)%% Tavg = mean(Fx) * b * 2*Z;       % [N]  Thrust   circumferential average thrust == force  in    +x direction%%FYavg = mean(Fy) * b * 2*Z;       % [N]           circumferential average      side force  in    +y direction%% Qavg = mean(Mz) * b * 2*Z;       % [Nm] torQue   circumferential average torque == moment about +z direction%PPavg = mean(Pp) * b * 2*Z;       % [W]  pitching power (parasitic power loss)%PZavg = mean(Pz) * b * 2*Z;       % [W]  shaft    power% Pavg = PPavg + PZavg;            % [W]  total    power%EFFY  = Tavg * Vs / Pavg;         % [ ]  efficiency%%--------------------------------------------------------------------------%%Pp = -Mp .* beta_dot;                  % [W/m]    pitching power  (per unit span) of the blade acting on the fluid  (i.e. power    put into    the fluid that needs to come from the prime mover)%Pz =  Mz  * w;                         % [W/m]    shaft    power  (per unit span) of the rotor acting on the fluid  (i.e. power    put into    the fluid that needs to come from the prime mover)%--------------------------------------------------------------------------\subsubsection{Steady lift and drag}The steady lift and drag forces (per unit span) are given by the usual equations:\begin{align}\vec{f}_{steady\atop lift} &= \half \rho V_r^2 \, \bar{c} \, C_L  \: (\hat{V}_r \times \shat)  \label{eq:lift} \\\vec{f}_{steady\atop drag} &= \half \rho V_r^2 \, \bar{c} \, C_D  \: (\hat{V}_r )                  \label{eq:drag}\end{align}where $\displaystyle \hat{V}_r = \frac{\vec{V}_r}{|\vec{V}_r|}$ is the unit vector in the relative inflow direction and $\shat = \yhat$ (since $\Gamma$ is defined positive in the $\yhat$ direction).  The drag force acts parallel to the relative inflow vector $\vec{V_r}$, at an angle $\alpha_F$ with the horizontal (see Table~\ref{tab:angles}).  The lift force acts perpendicular to $\vec{V_r}$ in accord with the Kutta--Joukowski theorem. %--------------------------------------------------------------------------\subsubsection{Unsteady lift}The unsteady lift (per unit span) is given by:\begin{equation}\vec{f}_{unsteady\atop lift} =  \rho \frac{d\Gamma_b}{dt}  \bar{c}   \: (\hat{V}_r \times \shat)  \label{eq:ulift}\end{equation}where the time derivative of the bound circulation can be evaluated numerically using the central difference formula.$$\frac{d\Gamma_b}{dt}(t\i) = \frac{\Gamma_b{\scriptstyle (i+1)} - \Gamma_b{\scriptstyle (i-1)} }{2 \delta t} $$%--------------------------------------------------------------------------\subsubsection{Flow curvature}Mathematically, the force due to flow curvature is simply a correction to the steady lift force:\begin{equation}\vec{f}_{flow\atop curvature} = \half \rho V_r^2 \, \bar{c} \, C_L^*  \: ( \hat{V}_r \times \shat)  \label{eq:lift_curve} \\\end{equation}where $C_L^*$ is the lift coefficient due to flow curvature, which is calculated as follows. \begin{figure}[hbt]\centering     \includegraphics[width=3.5 in]{flow_curvature_v116.pdf}     \label{fig:flow_curvature}     \caption[Flow Curvature Effect]{Illustration of flow curvature effect.  The actual velocity of the airfoil is $\vec V_q = -\xhat$, whereas the (relative velocity) flow direction illustrated here is $\vec V_r = - \vec V_q = \xhat$.} %  Reproduced from \citet{migliore1980}.}  \label{fig_flow_curvature}\end{figure} Physically, the flow curvature effect is illustrated in Figure~\ref{fig_flow_curvature}.  When a symmetric airfoil operates in a curved flow, this is roughly equivalent to a cambered airfoil operating in a straight flow.  In the case of the cycloidal rotor, the rotational motion of the rotor effectively produces a curved flow at the airfoil.  One tricky point is the direction/sign of the flow-curvature-induced lift force.   Figure~\ref{fig_flow_curvature} shows that the flow-curvature-induced lift acts towards the center of the circle (i.e.\ in the same direction as the centripetal acceleration of the airfoil).  In this figure,$\hat V_q = -\xhat$, $\hat V_r = -\hat V_q = \xhat$, $\hat a_q = \zhat$, and $\hat{f}_{flow\atop curvature} = \zhat$.  In this case, the direction of $\hat{f}_{flow\atop curvature}$ computed by equation \eqref{eq:lift_curve} is \begin{equation}  C_L^*(\hat{V}_r \times \shat) =  C_L^*(\xhat \times \yhat) = C_L^* \zhat\end{equation}so $C_L^*$ should be positive to make equation \eqref{eq:lift_curve} consistent with the direction of $\hat{f}_{flow\atop curvature}$ shown in the figure.Note that in this case, $(\hat V_q \times \hat a_q) \cdot \yhat  = (-\xhat \times \zhat) \cdot \yhat  = +1$.Thus, in order to use \eqref{eq:lift_curve}, the sign of $C_L^*$ must be set as follows: \begin{equation}  \text{sign}(C_L^*) = \text{sign}[( \hat V_q \times \hat a_q ) \cdot \yhat ]  \label{eq_sign_CL_flow_curvature}\end{equation}Hypothetically, if the figure were mirrored about the $\zhat$ axis, then $\hat V_q = \xhat$, $\hat a_q = \zhat$, and $\hat{f}_{flow\atop curvature} = \zhat$.Now equations \eqref{eq:lift_curve} and \eqref{eq_sign_CL_flow_curvature} would set \begin{align*}\hat{f}_{flow\atop curvature} &= \text{sign}[( \hat V_q \times \hat a_q ) \cdot \yhat ] \, (\hat{V}_r \times \shat) \\&= \text{sign}[\hphantom{_{qq}}( \xhat \times \zhat ) \cdot \yhat] \, ((-\xhat) \times \yhat) = [-1] \, (-\zhat) = \zhat\end{align*}as desired. The lift coefficient $C_L^*$ is computed as follows. At the aerodynamic center (quarter chord), $\vec r_q$, the effective radius of curvature is calculated as follows:\begin{equation}\label{eq:Rcurvature}R_{c} = \frac{|\vec V_{q}|^3}{|\vec V_{q} \times \vec a_{q}|}  \end{equation}where the velocity $\vec V_q$ and acceleration $\vec a_q$ of the quarter chord point are computed using \eqref{CRV_velocity} and \eqref{CRV_acceleration}, respectively.  (At the airfoil pitching point, $\vec V_0 = \omega R$ and $\vec a_0 = \omega^2 R$, so the radius of curvature is the rotor radius, $R_{c} = (\omega R)^3 / ( (\omega R)(\omega^2 R)) = R$, as expected.)  The camber ratio of a circular arc meanline is related to the radius of curvature via\begin{equation}\label{eq:f0oc}\frac{f_0}{\bar c} = \frac{R_{c}}{\bar c} - \left[ \left(\frac{R_{c}}{\bar c}\right)^2 -  \frac{1}{4} \right]^{\frac{1}{2}}\end{equation}(Thiart, 2005).  Practically, this value can be limited to a maximum of 0.1, since otherwise the flow will separate anyway.  The virtual lift coefficient may now be calculated using the formula for the circular arc meanline, but this formula is unnecessarily complicated.  For small camber ratios, a parabolic arc and a circular arc are very similar, and their lift coefficients are nearly identical. The lift coefficient for a parabolic arc meanline is simply\begin{equation}C_L = 4\pi\frac{f_0}{\bar c} \end{equation}(Thiart, 2005).  Note, for $f_0/\bar c < 0.1$, this formula agrees with that for the circular arc meanline within 2\%.  The sign of the radius of curvature can explicitly be included as follows: \begin{equation}\label{eq:CLcurve}C_L^* = C_L \, \text{sign}[( \hat V_q \times \hat a_q ) \cdot \yhat ]\end{equation}The lift coefficient from \eqref{eq:CLcurve} can now be inserted into \eqref{eq:lift_curve} to find $\vec{f}_{flow\atop curvature}$.%--------------------------------------------------------------------------\subsubsection{Added Mass}The added mass forces and moment are best described in blade $(1,2,3) \equiv (c,s,n)$ coordinates, with($\chat$,$\shat$,$\nhat$) as defined in Table~\ref{tab:angles}.The added mass loads act at the mid-chord position $\vec r_m$, given by \eqref{CRV_position}.  The velocity $\vec u_m = u_c \,\chat + u_n \nhat$ and rate of change of velocity $\mathring{\vec u}_m = \mathring{u}_c \,\chat + \mathring{u}_n \nhat$ are given by \eqref{CRV_velocity} and \eqref{CRV_added_mass_velocities}, respectively. Using standard added mass nomenclature, the motion of the cycloidal rotor blade is as follows: \begin{align*} (U_1,U_2,U_3) = (u_c,0,u_n) \quad\quad  \quad (U_4,U_5,U_6) = (\Omega_1,\Omega_2,\Omega_3) = (0,-\dot\beta_{abs},0)   \\(\dot U_1,\dot U_2,\dot U_3) = (\mathring u_c,0, \mathring u_n) \quad \quad\quad (\dot U_4,\dot U_5,\dot U_6) = (\dot\Omega_1,\dot\Omega_2,\dot\Omega_3) = (0,-\ddot\beta_{abs},0)\end{align*}The blade section can be modeled either as a 2D ellipse or 2D flat plate.%For a 2D plate of length $\bar c$ (and zero thickness), the only non-zero added mass coefficients are%\begin{subequations}%\begin{align}%(m_{cc} \equiv) \quad m_{11}  &= 0 \\%(m_{nn} \equiv) \quad m_{33}  &=       \pi     \rho \left(\frac{\bar c}{2}\right)^2 \\%(m_{ss} \equiv) \quad m_{55}  &= \frac{\pi}{8} \rho \left(\frac{\bar c}{2}\right)^4%\end{align}%\end{subequations}For a 2D ellipse with major and minor axis lengths of $\bar c$ and $t_0$ (section chord and thickness), the only non-zero added mass coefficients are\begin{subequations}\begin{align}(m_{cc} \equiv) \quad m_{11}  &=       \pi     \rho \left(\frac{t_0}{2}\right)^2 \\(m_{nn} \equiv) \quad m_{33}  &=       \pi     \rho \left(\frac{\bar c}{2}\right)^2 \\(m_{ss} \equiv) \quad m_{55}  &= \frac{\pi}{8} \rho \left( \left(\frac{\bar c}{2}\right)^2 - \left(\frac{t_0}{2}\right)^2\right)^2\end{align}\end{subequations}For a 2D flat plate of length $\bar c$ (and zero thickness), these equations still apply, with $t_0$ set to zero.%With these coefficients, the added mass loads (per unit span) reduce to:%\begin{align*}%F_1 &=          - \dot U_1      m_{11} \quad -  U_3 \Omega_2 m_{33}  \\%F_2 &=          -  U_1 \Omega_3 m_{11}  +  U_3 \Omega_1 m_{33}  \\%F_3 &= \phantom{-} U_1 \Omega_2 m_{11}       - \dot U_3 m_{33}  \\%%%F_4 &= \phantom{-  U_1 U_3 m_{11}}          - U_3 U_2 m_{33}  +  U_5 \Omega_3 m_{55}  \\%F_5 &=          -  U_1 U_3 m_{11}           + U_3 U_1 m_{33}  -  \dot U_5     m_{55}  \\%F_6 &= \phantom{-} U_1 U_2 m_{11}  \phantom{+ U_3 U_1 m_{33}}\, -  U_5 \Omega_1 m_{55}  %\end{align*}%and with the cycloidal rotor velocities, the only non-zero added mass loads (per unit span) are thenWith these coefficients and motions, the added mass loads (per unit span) reduce to:%\begin{align*}%(F_c \equiv \vec{f}_{added\atop mass} \cdot \chat \equiv ) \quad  F_1 &= - \dot U_1 m_{11} - U_3 \Omega_2 m_{33}	  &&& \ra && F_c &\equiv - \mathring u_c m_{cc} - u_n (-\dot\beta_{abs}) m_{nn}	\\%(F_n \equiv \vec{f}_{added\atop mass} \cdot \nhat \equiv ) \quad  F_3 &= - \dot U_3 m_{33} + U_1 \Omega_2 m_{11}	  &&& \ra && F_n &\equiv - \mathring u_n m_{nn} + u_c (-\dot\beta_{abs}) m_{cc} \\%(M_s \equiv \vec{m}_{added\atop mass} \cdot \shat \equiv ) \quad  F_5 &= - \dot U_5 m_{55} + U_1 U_3 (m_{33}-m_{11})  &&& \ra && M_s &\equiv - (-\ddot\beta_{abs}) m_{ss} + u_c u_n (m_{nn}-m_{cc})  %\end{align*}\begin{align*}F_1 &= - \dot U_1 m_{11} - U_3 \Omega_2 m_{33}	  	&&& \ra && F_c &\equiv - \mathring u_c m_{cc} - u_n (-\dot\beta_{abs}) m_{nn}	\\F_3 &= - \dot U_3 m_{33} + U_1 \Omega_2 m_{11}	  	&&& \ra && F_n &\equiv - \mathring u_n m_{nn} + u_c (-\dot\beta_{abs}) m_{cc} \\F_5 &= - \dot U_5 m_{55} + U_1 U_3 (m_{33}-m_{11})  &&& \ra && M_s &\equiv - (-\ddot\beta_{abs}) m_{ss} + u_c u_n (m_{nn}-m_{cc})  \end{align*}~\\[-4 em]\begin{align*}\vec{f}_{added\atop mass} &= F_c \chat + F_n \nhat  \\\vec{m}_{added\atop mass} &= M_s \shat \end{align*}%--------------------------------------------------------------------------\subsubsection{Acceleration reaction loads} The acceleration reaction loads (per unit span) are\begin{align}\vec{f}_{acceleration\atop reaction}   &= -\mu \vec a_a  \\\vec{m}_{acceleration\atop reaction}   &= -J  (-\ddot\beta_{abs} \shat )\end{align}These loads act at the foil center of mass, which is the centroid of area $(c_a,n=0)$.  For a NACA 00TT airfoil, the quantity $TT$ is the thickness to chord ratio (e.g. $TT=0.12$ for a NACA 0012).  The cross-sectional area is $area = 0.6849 (TT) \bar c^2$.  The mass per unit length of the airfoil is $\mu = \rho_b (area)$, where $\rho_b$ is the blade material density.  The chordwise location of the centroid is $c_a = 0.420410\bar c$.The mass (per unit length) moment of inertia about the centroid is $J =  0.1575 (TT)^3 \bar c^4 \rho_b$.  % [m^4 * kg/m^3 = kg*m^2/m]  ,V
\subsection{Loads}Once \CR has converged to a mathematically-consistent set of \{$\vec{V_r}$, $\alfa_{kin}$, $C_L$, $\Gamma_b$, $\Gamma_w$, and $\vec{U}$\}, the loads are then calculated. Again, if foil-foil and foil-wake interactions are ignored, then $\vec{U} = 0$, and \{$\vec{V_r}$, $\alfa_{kin}$, $C_L$, $\Gamma_b$\} are determined directly without iteration.Six forces and two moments (per unit length) are modeled in \CRV:\begin{equation}\vec{f}_{total\atop ~} = \vec{f}_{steady\atop lift} +\vec{f}_{steady\atop drag} +\vec{f}_{flow\atop curvature}  + \vec{f}_{unsteady\atop lift}+\vec{f}_{added\atop mass}  +\vec{f}_{acceleration\atop reaction}   \end{equation}\begin{equation}\vec{m}_{total\atop ~} = \vec{m}_{added\atop mass} +\vec{m}_{acceleration\atop reaction}    \end{equation}Since the foil is assumed to be symmetric, there is no moment about the center of pressure associated with the lift and drag forces.  %The first four forces (steady lift, steady drag, lift modification due to flow curvature, and unsteady lift) are all assumed to act at the aerodynamic center of pressure. For a symmetric airfoil (assumed herein), this is the quarter chord point $\vec r_q = (x_q,y_q)$, which can be calculated by setting $c_f = \bar c/4$ in \eqref{eq:Rf}. The hydrodynamic added mass force is assumed to act at the midpoint of the foil $\vec r_m = (x_m,y_m)$, which can be calculated by setting $c_f = \bar c/2$ in \eqref{eq:Rf}. The acceleration reaction force is assumed to act at the center of mass (centroid of area) $\vec r_a = (x_a,y_a)$, which is computed in the usual way. The foil pitching point is located at $\vec r_p = (x_p,y_p)$.  These loads will produce moments about the rotor axis (0,0) as follows:\begin{align}\vec m_z = & \:\vec r_q \times\left(\vec{f}_{steady\atop lift} +\vec{f}_{steady\atop drag} +\vec{f}_{flow\atop curvature}+\vec{f}_{unsteady\atop lift}\right) \nonumber \\ + & \,\vec r_m \times  \vec{f}_{added\atop mass}  \nonumber \\ + & \,\vec r_a \times  \vec{f}_{acceleration\atop reaction} \nonumber \\ +&\, \vec{m}_{added\atop mass} + \vec{m}_{acceleration\atop reaction}  \end{align}Similarly, these loads will produce moments about the pitching point $(x_p,y_p)$ as follows:\begin{align}\vec m_p = & \:(\vec r_q - \vec r_p) \times\left(\vec{f}_{steady\atop lift} +\vec{f}_{steady\atop drag} +\vec{f}_{flow\atop curvature}+\vec{f}_{unsteady\atop lift}\right) \nonumber \\ + & \,(\vec r_m - \vec r_p) \times  \vec{f}_{added\atop mass}  \nonumber \\ + & \,(\vec r_a - \vec r_p) \times  \vec{f}_{acceleration\atop reaction} \nonumber \\ +& \, \vec{m}_{added\atop mass} + \vec{m}_{acceleration\atop reaction}  \end{align}The circumferential average loads acting on both rotors over one revolution are \begin{align}\text{(thrust)} 		\quad 	T_{avg} 	&= \code{mean}\Big(\vec{f}_{total} \cdot \xhat\Big) \, b \, (2\Z) \\\text{(side force)} 	\quad 	Y_{avg} 	&= \code{mean}\Big(\vec{f}_{total} \cdot \yhat\Big) \, b \, (2\Z) \\\text{(torque)} 		\quad 	Q_{avg} 	&= \code{mean}\Big(\vec m_z        \cdot \zhat\Big) \, b \, (2\Z) \\\text{(shaft power)} 	\quad 	P_{S_{avg}} &= \code{mean}\Big( \dot\phi       \, (\vec m_z \cdot \zhat) \Big) \, b \, (2\Z) \\\text{(pitching power)} \quad 	P_{P_{avg}} &= \code{mean}\Big(-\dot\beta\, (\vec m_p \cdot \zhat) \Big) \, b \, (2\Z) \\\text{(total power)} 	\quad 	P_{avg} 	&= P_{S_{avg}} + P_{P_{avg}}\end{align}where $b$ is blade length, $\Z$ is the number of blades per rotor, and it is assumed that there are two rotors and thus $2\Z$ blades in total, as illustrated in Fig.~\ref{fig_configurations}. %The sign convention for power is that these are the parasitic power loss; they are the power of the blade acting on the fluid  (i.e. the power put into the fluid that needs to come from the prime mover). Since $\dot\beta_{abs}$ is positive counterclockwise (i.e. in the $\hat e_z$ direction), the power equation needs the negative sign explicitly. Since $\phi$ is positive clockwise (i.e. in the $-\hat e_z$ direction), the negative sign is built into the equation implicitly.  The efficiency of a cycloidal propeller is\begin{equation}\eta     = \frac{T_{avg} V_s}{P_{avg}}\label{eq:effy}\end{equation}%--------------------------------------------------------------------------\paragraph{Steady lift and drag}The steady lift and drag forces (per unit span) are given by the usual equations:\begin{align}\vec{f}_{steady\atop lift} &= \half \rho V_r^2 \, \bar{c} \, C_L  \: (\hat{V}_r \times \hat e_s)  \label{eq:lift} \\\vec{f}_{steady\atop drag} &= \half \rho V_r^2 \, \bar{c} \, C_D  \: (\hat{V}_r )                  \label{eq:drag}\end{align}where $\displaystyle \hat{V}_r = \frac{\vec{V}_r}{|\vec{V}_r|}$ is the unit vector in the relative inflow direction. The drag force acts parallel to the relative inflow vector $\vec{V_r}$, at an angle $\alpha_F$ with the horizontal (see Tab.~\ref{tab:angles}). The lift force acts perpendicular to $\vec{V_r}$ in accord with the Kutta--Joukowski theorem. %--------------------------------------------------------------------------\paragraph{Unsteady lift}The unsteady lift (per unit span) is given by:\begin{equation}\vec{f}_{unsteady\atop lift} =  \rho \frac{d\Gamma_b}{dt}  \bar{c}   \: (\hat{V}_r \times \hat e_s)  \label{eq:ulift}\end{equation}where the time derivative of the bound circulation can be evaluated numerically using the central difference formula.\begin{equation}\frac{d\Gamma_b}{dt}(t\i) = \frac{\Gamma_b{\scriptstyle (i+1)} - \Gamma_b{\scriptstyle (i-1)} }{2 \delta t} \end{equation}%--------------------------------------------------------------------------\paragraph{Flow curvature}Mathematically, the force due to flow curvature is simply a correction to the steady drag force:\begin{equation}\vec{f}_{flow\atop curvature} = \half \rho V_r^2 \, \bar{c} \, C_L^*  \: ( \hat{V}_r \times \hat e_s)  \label{eq:lift_curve} \\\end{equation}where $C_L^*$ is the lift coefficient due to flow curvature, which is calculated as follows. Physically, when a symmetric airfoil operates in a curved flow, this is roughly equivalent to a cambered airfoil operating in a uniform flow. In the case of the cycloidal rotor, the rotational motion of the rotor effectively produces a curved flow at the airfoil. At the airfoil pitching point, the radius of curvature is the rotor radius, $R$. At the aerodynamic center (quarter chord), the effective radius of curvature will be slightly different; the radius of curvature is calculated by \begin{equation}\label{eq:Rcurvature}R_{c} = \frac{|\vec V_{q}|^3}{\vec a_{q} \times \vec V_{q}}  \end{equation}The position $\vec r_q$, velocity $\vec V_q$, and acceleration $\vec a_q$ of the quarter chord point `$q$' are given by \eqref{eq:Rf}, \eqref{eq:Vf}, and \eqref{eq:Af}, respectively, with $c_f = \bar c/4$.The camber ratio of a circular arc meanline is related to the radius of curvature via\begin{equation}\label{eq:f0oc}\frac{f_0}{\bar c} = \frac{|R_{c}|}{\bar c} - \left[ \left(\frac{|R_{c}|}{\bar c}\right)^2 -  \frac{1}{4} \right]^{\frac{1}{2}}\end{equation}\cite{Thiart2005}. Practically, this value can be limited to a maximum of 0.1, since otherwise the flow will separate. For simplicity, the virtual lift coefficient is calculated using a parabolic arc meanline, which closely approximates a circular arc for small camber ratios:\begin{equation}C_L = 4\pi\frac{f_0}{\bar c}\end{equation}\cite{Thiart2005}. Note, for $f_0/\bar c < 0.1$, this formula agrees with that for the circular arc meanline within 2\%. The sign of the radius of curvature can explicitly be included as follows: \begin{equation}\label{eq:CLcurve}C_L^* = C_L \frac{R_{c}}{|R_{c}|}\end{equation}This lift coefficient is inserted into \eqref{eq:lift_curve} to find $\vec{f}_{flow\atop curvature}$.% \clearpage%--------------------------------------------------------------------------\paragraph{Added Mass}The added mass forces and moment are best described in blade $(c,s,n)$ coordinates, with$c$ chordwise towards trailing edge, $s$  spanwise out of page (i.e. in the $z$ direction), $n$ normal (radially outward for $\phi = \beta = 0$) nominally out of the suction side for $\beta,\phi < 90$ deg. Recall, the position $\vec r_m$, velocity $\vec V_m$, and acceleration $\vec a_m$ of the mid-chord point `$m$' (where the added mass loads act) are given by \eqref{eq:Rf}, \eqref{eq:Vf}, and \eqref{eq:Af}, respectively, with $c_f = \bar c/2$. The only non-zero added mass coefficients for a 2D plate of width $\bar c$ are\begin{align}(``M_{22}") \quad M_{nn}  &=       \pi     \rho \left(\frac{\bar c}{2}\right)^2 \\(``M_{66}") \quad M_{ss}  &= \frac{\pi}{8} \rho \left(\frac{\bar c}{2}\right)^4\end{align}The non-zero added mass loads (per unit span) are then\begin{align}(``F_{1}") \quad \vec{f}_{added\atop mass} \cdot \hat c &= -M_{nn}(\vec V_m \cdot \hat n)(\dot\beta-\dot\phi)  \\      % [N/m]   chord-wise force(``F_{2}") \quad \vec{f}_{added\atop mass} \cdot \hat n &= -M_{nn}(\vec a_m \cdot \hat n)    \\                        % [N/m]   normal force(``F_{6}") \quad \vec{m}_{added\atop mass} \cdot \hat s &=  M_{nn}(\vec V_m \cdot \hat c)(\vec V_m \cdot \hat n) - M_{ss}\ddot\beta  % [N-m/m] spanwise moment\end{align}%--------------------------------------------------------------------------\paragraph{Acceleration reaction loads} The acceleration reaction loads (per unit span) are\begin{align}\vec{f}_{acceleration\atop reaction}   &= -\mu \vec a_a  \\\vec{m}_{acceleration\atop reaction}   &= -I_{zz}  \ddot\beta_{abs} \hat z  \end{align}where $\mu$ is the mass per unit length and $I_{zz}$ is the mass moment of inertia per unit length.  These loads act at the foil center of mass, which is the centroid of area $(c_a,n=0)$.  ,V
\hat e_z ,v
equation,v
$V_l$ are ,v
$V_u$ and ,v
\quad \text{and} \\,v
\end{gather},V
\begin{gather},V
    \begin{aligned}        C_1 = 0.6 && C_2 = \frac{c}{2 V_s \delta t}    \end{aligned},V
where ,v
gather,v
test,v
points,v
upper and lower ,v
total,v
\begin{equation}\end{equation},V
\newcommand{\GB}{\Gamma_b},V
equatio,v
n,v
i,v
\,v
    a = b,V
;,v
},v
[Lift and drag coefficients],v
%Equation \eqref{eq:GW} fails for $\GW{\scriptstyle (1)}$, since $\GB{\scriptstyle (0)} = \GB(t{\scriptstyle (0)}=0)$ does not exist, as the simulation only considers times $t\i = i \: \delta t$ for $i = 1,\ldots, N$.  ,V
 % $(x_w{\scriptstyle (i,N_w)},z_w{\scriptstyle (i,N_w)}) = (x_t{\scriptstyle (i)},z_t{\scriptstyle (i)})$ is,V
The circulation of these wake vortices is computed as follows. ,v
%--------------------------------------------------------------------------\paragraph{Wake Strength}                         The circulation of these wake vortices is computed as follows. ,v
so ,v
However,,v
The circulation of the bound vortices and wake vortices is computed as follows. By Kelvin's theorem, circulation is deposited into the wake is related to temporal changes in bound circulation of the hydrofoil. The \emph{bound circulation} about the foil is, by the Kutta-Joukowski theorem: ($L_{mag} = \rho V_r \Gamma_b$) and Eq.~\eqref{eq:lift}:\begin{equation}\GB = \half \bar{c} V_r C_L\end{equation}The vortex shed from the key blade at time-step $t\i$ has position  $\vec x_w{\scriptstyle (i,N_w)} = \vec x_t{\scriptstyle (i)}$ and circulation % $(x_w{\scriptstyle (i,N_w)},y_w{\scriptstyle (i,N_w)}) = (x_t{\scriptstyle (i)},y_t{\scriptstyle (i)})$ is\begin{equation}\label{eq:GW}\GW\i = \int\limits_{t\im}^{t\i} \frac{d\GB}{dt} dt =  \GB\im - \GB\i\end{equation}Equation \eqref{eq:GW} fails for $\GW{\scriptstyle (1)}$, since $\GB{\scriptstyle (0)} = \GB(t{\scriptstyle (0)}=0)$ does not exist, as the simulation only considers times $t\i = i \: \delta t$ for $i = 1,\ldots, N$; however, $\GB$ is periodic in $\phi$, so $\GB{\scriptstyle (0)} = \GB{\scriptstyle (N)}$, and therefore $\GW{\scriptstyle (1)} = \GB{\scriptstyle (0)} - \GB{\scriptstyle (1)} = \GB{\scriptstyle (N)} - \GB{\scriptstyle (1)}$.,V
The circulation of these wake vortices is computed as follows.  By Kelvin's theorem, circulation is deposited into the wake is related to temporal changes in bound circulation of the hydrofoil. {\color{red}The \it{bound circulation} about the foil is (by the Kutta-Joukowski theorem: $L_{mag} = \rho V_r \Gamma_b$ and equation \eqref{eq:lift}):\begin{equation}\GB = \half \bar{c} V_r C_L\end{equation}%The vortex shed from the key blade at time-step $t\i$ has position  $\vec r_w{\scriptstyle (i,N_w)} = \vec r_t{\scriptstyle (i)}$ }and circulation % $(x_w{\scriptstyle (i,N_w)},z_w{\scriptstyle (i,N_w)}) = (x_t{\scriptstyle (i)},z_t{\scriptstyle (i)})$ is\begin{equation}\label{eq:GW}\GW\i = \int\limits_{t\imo}^{t\i} \frac{d\GB}{dt} dt =  \GB\imo - \GB\i\end{equation}Equation \eqref{eq:GW} fails for $\GW{\scriptstyle (1)}$, since $\GB{\scriptstyle (0)} = \GB(t{\scriptstyle (0)}=0)$ does not exist, as the simulation only considers times $t\i = i \: \delta t$ for $i = 1,\ldots, N$.  However, $\GB$ is periodic in $\phi$, so $\GB{\scriptstyle (0)} = \GB{\scriptstyle (N)}$, and therefore $\GW{\scriptstyle (1)} = \GB{\scriptstyle (0)} - \GB{\scriptstyle (1)} = \GB{\scriptstyle (N)} - \GB{\scriptstyle (1)}$.,V
E,v
Thus, ,v
presented ,v
T,v
% \CRV gives the user the option of including or ignoring wake alignment.  If wake alignment is ignored, then the wake advects with the free stream. If wake alignment is included, an iterative procedure is used to find the circulation and induced velocity field based on the wake geometry, and vice versa until convergence is achieved.  %then the following procedure is used: $(i)$ the wake geometry is frozen from the previous solution iteration, $(ii)$ the circulation is updated from the current solution iteration; $(iii)$ the induced velocity field is computed using this frozen wake; $(iv)$ the wake geometry is then updated by advecting the wake with the free stream plus this induced velocity field.,V
more accurately ,v
The analysis is performed at discrete rotor angles $\phi\i = i \: 2\pi/N$ for $i=1,\ldots,N$, which correspond to times $t\i = i \: T/N = i \: \delta t$, where $\delta t = T/N$ is the time step, and $T = 2\pi/\omega$ is the period for one revolution.  ,v
interpolated from  ,v
e,v
closer to the leading edg,v
not at the trailing edge,v
Now consider the case of including wake alignment.  Equation \eqref{eq:advect_no} is used to initialize the wake for the first solution iteration.  ,v
N,v
First, consider the case of no wake alignment, in which case we can set $\vec{U}^*=0$ in \eqref{eq:advect1} such that the wake advects with the free stream ($V_s \xhat$).  In this case, \eqref{eq:advect1} simplifies to:\begin{subequations}\label{eq:advect_no}\begin{align}x_w{\scriptstyle (i,j)} &= x_w{\scriptstyle (i-1,j+1)}  + V_s  \: dt  \\z_w{\scriptstyle (i,j)} &= z_w{\scriptstyle (i-1,j+1)} \end{align}\end{subequations},V
% $(x_w{\scriptstyle (i,N_w)},z_w{\scriptstyle (i,N_w)})$,v
% $(x_w{\scriptstyle (i,1)},z_w{\scriptstyle (i,1)})$ ,v
% Since induced velocity decays as $O(r^{-1})$, only a finite wake length, comprised of $N_w$ vortices, is needed (numerical experiments show that the converged loads are insensitive to wake lengths greater than $10R$ up to four significant digits). For each time step $\scriptstyle i = 1,2,\ldots,N$, for each wake position $\scriptstyle j = N_w-1,N_w-2,\ldots,1$, % \begin{subequations}% \label{eq:advect1}% \begin{align}% x_w{\scriptstyle (i,j)} &= x_w{\scriptstyle (i-1,j+1)} + \int_{\displaystyle t\im}^{\displaystyle t\i} [ U_x(x,y,t) -V_s ] \: dt  \\% y_w{\scriptstyle (i,j)} &= y_w{\scriptstyle (i-1,j+1)} + \int_{\displaystyle t\im}^{\displaystyle t\i}  U_y(x,y,t)       \: dt % \end{align}% \end{subequations}%%% First, consider the case of no wake alignment, in which case we can set $\vec{U}=0$ in \eqref{eq:advect1} such that the wake advects with the free stream ($-V_s \xhat$). In this case, \eqref{eq:advect1} simplifies to:% \begin{subequations}% \label{eq:advect_no}% \begin{align}% x_w{\scriptstyle (i,j)} &= x_w{\scriptstyle (i-1,j+1)}  - V_s  \: dt  \\% y_w{\scriptstyle (i,j)} &= y_w{\scriptstyle (i-1,j+1)} % \end{align}% \end{subequations}%% Now consider the case of including wake alignment. Equation \eqref{eq:advect_no} is used to initialize the wake for the first solution iteration. For subsequent iterations, \eqref{eq:advect1} is evaluated using a predictor-corrector method.,V
Since induced velocity decays as $O(r^{-1})$, only a finite wake length is needed (numerical experiments show that the converged loads are insensitive to wake lengths greater than $10R$ up to four significant digits).  Thus, a finite number of vortices are needed to model the wake, $N_w$.  Also, because of periodicity, the wake geometry from the other blades is identical to that of the key blade, accounting for the phase shift between the blades.  Thus, the wake geometry $\vec r_w = (x_w,z_w)$ can be recorded using two $[N,N_w]$ arrays, where the $(i,j)$ entry corresponds to time-step $i$ and wake position $j$.  Wake position $j=1$ corresponds to the far wake, and $j=N_w$ corresponds to the near wake.  That is, vortex $\vec r_w{\scriptstyle (i,1)}$ is far downstream, and {\color{red} vortex $\vec r_w{\scriptstyle (i,N_w)}$ is at the foil trailing edge:\begin{subequations}\begin{align}x_w{\scriptstyle (i,N_w)} &= x_t\i \\z_w{\scriptstyle (i,N_w)} &= z_t\i\end{align}\end{subequations}Thus, at each timestep, vortex $\vec r_w{\scriptstyle (i,N_w)}$ % $(x_w{\scriptstyle (i,N_w)},z_w{\scriptstyle (i,N_w)})$ is created at the trailing edge, }the `oldest' vortex $\vec r_w{\scriptstyle (i,1)}$ % $(x_w{\scriptstyle (i,1)},z_w{\scriptstyle (i,1)})$  evaporates, and the other vortices shift in wake position $j$.Between time-steps $i-1$ and $i$, the vortex in wake position $j+1$ advects downstream to wake position $j$.  Thus, for each time step $\scriptstyle i = 1,2,\ldots,N$, for each wake position $\scriptstyle j = N_w-1,N_w-2,\ldots,1$, \begin{subequations}\label{eq:advect1}\begin{align}x_w{\scriptstyle (i,j)} &= x_w{\scriptstyle (i-1,j+1)} + \int_{t\imo}^{t\i} [ U^*_x(x,z,t) + V_s ] \: dt  \\z_w{\scriptstyle (i,j)} &= z_w{\scriptstyle (i-1,j+1)} + \int_{t\imo}^{t\i}   U^*_z(x,z,t)         \: dt \end{align}\end{subequations},V
For computational efficiency, ,v
For computational efficiency, the \CRV wake model consists of discrete vortices, one shed from the trailing edge of each blade at each time-step.    The analysis is performed at discrete rotor angles $\phi\i = i \: 2\pi/N$ for $i=1,\ldots,N$, which correspond to times $t\i = i \: T/N = i \: \delta t$, where $\delta t = T/N$ is the time step, and $T = 2\pi/\omega$ is the period for one revolution.  ,V
% For computational efficiency, the wake model consists of discrete vortices, one shed from the trailing edge of each blade at each time-step. The location of the trailing edge $(x_t,y_t)$ is given by substituting $c_f=\bar c$ into \eqref{eq:Rf}. The analysis is performed at discrete rotor angles. The location of the bound vortex $(x_b,y_b)$ of the key blade is given by substituting $c_f=c_b$ into \eqref{eq:Rf} for some user-specified choice of $c_b$.,v
vortex circulation,v
bound,v
Illustration of free wake model.,v
DESCRIBE WAKE MODEL HERE. ,v
h,v
p,v
{,v
\tfrac,v
The numerical algorithm is as follows.  ,v
%		\caption{\small \texttt{CyROD} OPTIMIZES THE ANGLE $\beta$ OR $\beta_{abs}$, DEPENDING ON WHICH IS CONTINUOUS FOR A GIVEN $\lambda$.  NOTE: $\beta_{abs} < 0$ AS SHOWN; ALL OTHER ANGLES POSITIVE AS SHOWN.},V
%		\caption{\small THE BLADE PITCH ANGLE $\beta$ IS DEFINED RELATIVE TO THE TANGENT, WHILE $\beta_{abs}$ IS DEFINED RELATIVE TO THE HORIZONTAL},V
2.25in,v
0.9\columnwidth,v
3in,v
5,v
.,v
2,v
\small ,v
We model cycloidal propellers using a ,v
 singularity,v
discretizing,v
representing ,v
b,v
u,v
s,v
so,v
In this case, ,v
% %--------------------------------------------------------------------------% \subsection{Induced Velocity Calculation}%,V
%Having outlined the position and strength of each vortex, we are now able to compute the induced velocity from the wake. The induced velocities at field point ($x,y$) at time $t\i$ are as follows:%\begin{subequations}%\begin{align}%U_x(x,y,t\i) &= \sum\limits_{k=0}^{Z-1} \left\{ \GB \I \frac{-(y-y_b \I)}{2 \pi \left[r_b \I^2 + \epsilon^2 \right]} + \sum\limits_{j=1}^{N_w} \Gamma_w \J \frac{-(y-y_w \Ij)}{2\pi\left[r_w \Ij^2 + \epsilon^2\right]} \right\}  \label{eq:UxInteract} \\%U_y(x,y,t\i) &= \sum\limits_{k=0}^{Z-1} \left\{ \GB \I \frac{  x-x_b\I }{2 \pi \left[r_b\I^2 + \epsilon^2 \right]} + \sum\limits_{j=1}^{N_w} \Gamma_w \J \frac{  x-x_w \Ij }{2\pi\left[r_w \Ij^2 + \epsilon^2\right]} \right\}  \label{eq:UyInteract}%\intertext{where}  %I &= \code{mod}(i+k N_{sep} -1, N) +1   \\%J &= \code{mod}(j+I -1,N)+1  \\%r_b\I^2 &= \left(x-x_b\I  \right)^2 + \left( y-y_b\I  \right)^2  \\%r_w\Ij^2 &= \left(x-x_w\Ij \right)^2 + \left( y-y_w\Ij \right)^2  %\end{align}%\end{subequations},V
%,v
%%%,V
